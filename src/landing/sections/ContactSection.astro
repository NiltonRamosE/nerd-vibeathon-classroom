---
import ScrollingBanner from "@/landing/components/ScrollingBanner.astro";

const frases = [
  "¿Te gustaría mejorar tu organización? 📅🛠️",
  "Aquí estamos para ayudarte a organizar tu aprendizaje y avanzar de manera efectiva 📈💡",
  "Cada paso que das es importante, y nosotros estamos contigo en cada uno de ellos 🚶‍♂️📚",
  "No estás solo en este camino, te apoyamos en cada desafío 💪🎓",
  "¡Juntos podemos lograr que tu experiencia de aprendizaje sea más fácil y clara! 🌟📘",
  "No dejes que nada se te escape. Aquí tienes todas las herramientas para avanzar con éxito 🚀📊",
  "Tu esfuerzo es valioso, y estamos aquí para asegurarnos de que sigas avanzando 🌱💼",
];

---

<section class="text-center">
  <ScrollingBanner phrases={frases} />
 
  <h3 class="text-2xl font-medium relative inline-block mt-10">
    CONTÁCTANOS AHORA
    <br />
    <span class="text-theme-amber text-4xl font-bold block mt-2">
      ¿QUÉ MEDIO PREFIERES?
    </span>

    <span class="block h-[2px] w-64 bg-theme-amber mx-auto mt-6 transition-all duration-300 hover:w-120"></span>
  </h3>

  <div class="flex flex-wrap justify-center gap-4 mt-10 px-4 sm:px-0">
    <a
      href="https://wa.me/51951011604"
      target="_blank"
      class="flex items-center justify-center gap-2 bg-theme-amber text-theme-rich-black px-6 py-4 w-90 rounded-2xl font-regular text-xl shadow-md transition hover:bg-theme-amber/90"
    >
      <img src="/images/whatsapp-icon.svg" alt="icono de WhatsApp" class="w-6 h-6" />
      WhatsApp
    </a>


    <a
      href="tel:+51951011604"
      class="flex items-center gap-2 justify-center bg-theme-rich-black text-theme-seasalt px-6 py-4 w-90 rounded-2xl font-regular text-xl shadow-md transition hover:bg-theme-rich-black/90"
    >
      <img src="/images/phone-icon.svg" alt="icono de telefono" class="w-6 h-6" />
      Llamar ahora
    </a>

    <a
      href="mailto:niltonencarnacion17@gmail.com"
      class="flex items-center gap-2 justify-center bg-theme-shamrock-green text-theme-rich-black px-6 py-4 w-90 rounded-2xl font-regular text-xl shadow-md transition hover:bg-theme-shamrock-green/90"
    >
      <img src="/images/mail-icon.svg" alt="icono de correo" class="w-6 h-6" />
      Correo
    </a>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-24 mt-32 items-stretch px-4 sm:px-24">
    <div class="flex items-center justify-center">
      <div class="bg-white p-6 rounded-4xl shadow-brand-card w-xl h-full">
        <h4 class="text-xl font-bold mb-12 text-theme-rich-black text-left mt-4">Escribe tu mensaje</h4>
        <form id="ContactGoogleForm" class="space-y-8 w-full max-w-xl" action="https://docs.google.com/forms/d/1ORWFKdbj8Vwpn5mviKg7LSiIRwipenWUad7Bgn_4YWo/formResponse" method="POST" target="hidden_iframe" novalidate>
          <div class="flex flex-col md:flex-row gap-4">
            <div class="w-full">
              <span class="block text-sm font-medium text-theme-rich-black mb-1 text-left">Nombres <span class="text-red-600">*</span></span>
              <input
                id="nombres"
                name="entry.917920380"
                type="text"
                class="w-full px-4 py-3 border border-theme-rich-black/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-theme-amber"
              />
            </div>
            <div class="w-full">
              <span class="block text-sm font-medium text-theme-rich-black mb-1 text-left">Apellidos <span class="text-red-600">*</span></span>
              <input
                id="apellidos"
                name="entry.992539036"
                type="text"
                class="w-full px-4 py-3 border border-theme-rich-black/50  rounded-lg focus:outline-none focus:ring-2 focus:ring-theme-amber"
              />
            </div>
          </div>

          <div>
            <span class="block text-sm font-medium text-theme-rich-black mb-1 text-left">Correo <span class="text-red-600">*</span></span>
            <input
              id="correo"
              name="entry.1582120582"
              type="email"
              class="w-full px-4 py-3 border border-theme-rich-black/50  rounded-lg focus:outline-none focus:ring-2 focus:ring-theme-amber"
            />
          </div>

          <div>
            <span class="block text-sm font-medium text-theme-rich-black mb-1 text-left">Celular <span class="text-red-600">*</span></span>
            <input
              name="entry.1317356111"
              type="tel"
              class="w-full px-4 py-3 border border-theme-rich-black/50  rounded-lg focus:outline-none focus:ring-2 focus:ring-theme-amber"
            />
          </div>

          <div>
            <span class="block text-sm font-medium text-theme-rich-black mb-1 text-left">Mensaje <span class="text-red-600">*</span></span>
            <textarea
              name="entry.1510882835"
              rows="5"
              class="w-full px-4 py-3 border border-theme-rich-black/50  rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-theme-amber"
            ></textarea>
          </div>

          <button
            type="submit"
            class="bg-theme-amber text-theme-rich-black border-2 border-b-6 border-theme-rich-black font-medium py-3 px-6 rounded-4xl hover:bg-theme-amber/90 transition-colors duration-200"
          >
            Enviar mensaje
          </button>
        </form>
      </div>
    </div>
    
    <div class="flex flex-col">
      <div class="text-center lg:text-left">
        <h5 class="text-xl font-bold text-theme-rich-black mb-2">¿Algo más rápido? ¡Claro!</h5>
        <p class="text-theme-rich-black font-regular">
          <span class="font-bold">Tel:</span> +51 951 011 604
        </p>
        <p class="text-theme-rich-black font-regular">
          <span class="font-bold">Correo:</span> <a href="mailto:niltonencarnacion17@gmail.com">niltonencarnacion17@gmail.com</a>
        </p>
      </div>

      <div class="flex-grow flex items-center justify-center mt-10">
        <img src="/images/hands-3d.webp" alt="Contacto ilustración" class="w-lg h-lg lg:w-full lg:h-full object-contain" loading="lazy" />
      </div>
    </div>
  </div>
</section>

<style>
  .shadow-brand-card {
    box-shadow: 6px 6px 10px rgba(0, 0, 0, 0.3);
  }
</style>

<script is:inline>
  document.getElementById("ContactGoogleForm").addEventListener("submit", function (event) {
    let form = this;
    let valid = true;

    // Convertir nombres y apellidos a mayúsculas automáticamente
    let apellidos = form.querySelector("#apellidos");
    let nombres = form.querySelector("#nombres");
    if (apellidos) apellidos.value = apellidos.value.toUpperCase();
    if (nombres) nombres.value = nombres.value.toUpperCase();

    // Validación del correo manualmente
    let correo = form.querySelector("#correo");
    let gmailPattern = /^[a-zA-Z0-9._%+-]+@gmail\.com$/;

    if (!gmailPattern.test(correo.value)) {
      valid = false;
    }

    // Validar otros campos (evita que todos se marquen incorrectos de golpe)
    form.querySelectorAll("input:not(#correo), textarea").forEach(input => {
      if (!input.checkValidity()) {
        valid = false;
      }
    });

    // Si hay errores, detenemos el envío
    event.preventDefault();
    if (!valid) {
      event.stopPropagation();
    } else {
      let formData = new FormData(this);
      fetch(this.action, { method: "POST", body: formData })
      this.reset();
    }
  });
</script>