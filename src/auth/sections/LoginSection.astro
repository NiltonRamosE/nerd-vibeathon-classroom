---

---

<section class="grid grid-cols-1 md:grid-cols-2 pt-22 md:pt-20">
  <!-- PARA PC -->
  <div class="hidden md:block">
    <img
      src="/images/bg-login-pc.webp"
      alt="Imagen de bienvenida"
      class="w-md h-md lg:w-lg lg:h-lg xl:w-4xl xl:h-4xl"
      loading="lazy"
    />
  </div>

  <!-- Aqu√≠ ir√≠a la imagen de fondo para celular-->
  <div class="md:hidden w-full relative p-0">
    <div class="m-0 h-full w-full absolute">
      <div class="overflow-hidden h-full absolute w-full">
        <img
          src="/images/bg-message.webp"
          alt=" Imagen de bienvenida"
          class="w-full h-full scale-160 object-cover"
          loading="lazy"
        />
      </div>
    </div>
    <div
      class="relative w-full h-full pt-18 p-8 md:p-10 md:pb-0 sm:p-15 sm:pb-0 pb-0"
    >
      <div class="">
        <h1 class="text-5xl sm:text-6xl font-semibold mb-2">¬°Bienvenido!</h1>
      </div>
      <div class="flex w-full mb-0 p-0 justify-between flex-wrap">
        <p class="w-1/2 text-xl sm:text-3xl font-light">
          Probar o crecer, todo comienza aqu√≠.
        </p>

        <div class="w-1/2">
          <img
            src="/images/bg-login-guy.webp"
            alt="Imagen de bienvenida"
            class="object-cover scale-x-[-1]"
            loading="lazy"
          />
        </div>
      </div>
    </div>
  </div>

  <!-- Secci√≥n del formulario -->
  <div
    class="flex items-center justify-center px-5 sm:px-10 lg:px-0 md:rounded-none md:mt-0 rounded-b-none rounded-4xl z-20 mt-[-50px] bg-theme-white pt-10"
  >
    <div class="w-full max-w-md">
      <div id="loginState" class="transition-all duration-300">
        <div id="userTypeSelection" class="w-full">
          <h2 class="text-3xl font-bold mb-10 text-center">¬øC√≥mo deseas ingresar?</h2>
          <div class="grid grid-cols-1  gap-8 mb-8">
            <!-- Tarjeta Estudiante -->
            <button
              onclick="showLoginForm('student')"
              class="group bg-white text-theme-rich-black border-2 border-b-8 border-theme-rich-black font-medium p-8 rounded-3xl hover:bg-theme-amber/5 transition-all duration-300 hover:scale-[1.02] shadow-lg hover:shadow-theme-amber/20 text-left h-full flex flex-col"
            >
              <div class="flex items-start mb-6">
                <div class="mr-6 w-16 h-16 bg-theme-amber rounded-2xl flex items-center justify-center group-hover:bg-theme-amber transition-colors duration-300">
                  <span class="text-2xl">üë®‚Äçüéì</span>
                </div>
                <div>
                  <h3 class="font-bold text-2xl mb-2">Estudiante</h3>
                  <p class="text-base font-light text-gray-600">Una forma m√°s f√°cil de interactuar.</p>
                </div>
              </div>
              <div class="mt-auto pt-4 border-t border-theme-rich-black/20">
                <div class="flex items-center text-theme-amber font-medium">
                  <span>Ingresar como estudiante</span>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 transform group-hover:translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                  </svg>
                </div>
              </div>
            </button>

            <!-- Tarjeta Docente -->
            <button
              onclick="showLoginForm('instructor')"
              class="group bg-white text-theme-rich-black border-2 border-b-8 border-theme-rich-black font-medium p-8 rounded-3xl hover:bg-theme-amber/5 transition-all duration-300 hover:scale-[1.02] shadow-lg hover:shadow-theme-amber/20 text-left h-full flex flex-col"
            >
              <div class="flex items-start mb-6">
                <div class="mr-6 w-16 h-16 bg-theme-amber rounded-2xl flex items-center justify-center group-hover:bg-theme-amber-dark transition-colors duration-300">
                  <span class="text-2xl">üë©‚Äçüè´</span>
                </div>
                <div>
                  <h3 class="font-bold text-2xl mb-2">Docente</h3>
                  <p class="text-base font-light text-gray-600">No te quedes atr√°s y aprende con nosotros.</p>
                </div>
              </div>
              <div class="mt-auto pt-4 border-t border-theme-rich-black/20">
                <div class="flex items-center text-theme-amber font-medium">
                  <span>Ingresar como docente</span>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 transform group-hover:translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                  </svg>
                </div>
              </div>
            </button>

            <!-- Tarjeta Administrador -->
            <button
              onclick="showLoginForm('administrator')"
              class="group bg-white text-theme-rich-black border-2 border-b-8 border-theme-rich-black font-medium p-8 rounded-3xl hover:bg-theme-amber/5 transition-all duration-300 hover:scale-[1.02] shadow-lg hover:shadow-theme-amber/20 text-left h-full flex flex-col"
            >
              <div class="flex items-start mb-6">
                <div class="mr-6 w-16 h-16 bg-theme-amber rounded-2xl flex items-center justify-center group-hover:bg-theme-amber-dark transition-colors duration-300">
                  <span class="text-2xl">üë®‚Äçüíº</span>
                </div>
                <div>
                  <h3 class="font-bold text-2xl mb-2">Administrador</h3>
                  <p class="text-base font-light text-gray-600">Gestiona la plataforma.</p>
                </div>
              </div>
              <div class="mt-auto pt-4 border-t border-theme-rich-black/20">
                <div class="flex items-center text-theme-amber font-medium">
                  <span>Ingresar como administrador</span>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2 transform group-hover:translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                  </svg>
                </div>
              </div>
            </button>
          </div>
        </div>

        <!-- Paso 2: Formulario de login (oculto inicialmente) -->
        <div id="loginForm" class="hidden">
          <div class="flex items-center mb-6 cursor-pointer" onclick="showUserTypeSelection()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
            </svg>
            <span class="text-sm font-medium">Volver a selecci√≥n</span>
          </div>

          <h2 id="formTitle" class="text-2xl font-bold mb-6"></h2>
          
          <form id="actualLoginForm">
            <input type="hidden" id="userType" name="userType" value="">
            
            <div class="mb-10 md:mb-5 xl:mb-10">
              <label for="institutionalEmail" class="block text-sm font-bold">
                Correo Institucional <span class="text-red-500">*</span>
              </label>
              <input
                type="email"
                id="institutionalEmail"
                name="institutionalEmail"
                required
                autocomplete="username"
                class="w-full md:w-xs lg:w-full border rounded-md px-4 py-2 mt-1 border-theme-rich-black/40"
              />
            </div>

            <div class="mb-10 md:mb-5 xl:mb-10">
              <label for="password" class="block text-sm font-bold">
                Contrase√±a <span class="text-red-500">*</span>
              </label>
              <input
                type="password"
                id="password"
                name="password"
                required
                autocomplete="current-password"
                class="w-full md:w-xs lg:w-full border rounded-md px-4 py-2 mt-1 border-theme-rich-black/40"
              />
            </div>

            <button
              type="submit"
              class="w-full md:w-xs lg:w-full bg-theme-amber text-theme-rich-black border-2 border-b-8 border-theme-rich-black font-medium py-3 px-6 rounded-2xl hover:bg-theme-amber/90 transition-colors duration-200"
            >
              Iniciar sesi√≥n
            </button>
          </form>

          <div class="w-full md:w-xs lg:w-full my-10 md:my-4 lg:my-10 border-t border-theme-rich-black/40"></div>

          <div class="flex items-center justify-between mb-6 w-full md:w-xs lg:w-full">
            <p class="mb-2 font-light">¬øTienes alguna duda?</p>
            <a
              href="/nosotros"
              class="text-theme-amber hover:underline font-medium"
            >
              Contactate con nosotros
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script is:inline>
  function showLoginForm(userType) {
    const selection = document.getElementById('userTypeSelection');
    const form = document.getElementById('loginForm');
    const formTitle = document.getElementById('formTitle');
    const userTypeInput = document.getElementById('userType');
    
    let title = '';
    switch(userType) {
      case 'student':
        title = 'Inicio de sesi√≥n para Estudiantes';
        break;
      case 'instructor':
        title = 'Inicio de sesi√≥n para Docentes';
        break;
      case 'administrator':
        title = 'Inicio de sesi√≥n para Administradores';
        break;
    }
    
    formTitle.textContent = title;
    userTypeInput.value = userType;
    selection.classList.add('hidden');
    form.classList.remove('hidden');
  }
  
  function showUserTypeSelection() {
    const selection = document.getElementById('userTypeSelection');
    const form = document.getElementById('loginForm');
    
    selection.classList.remove('hidden');
    form.classList.add('hidden');
  }
  
  document.getElementById('actualLoginForm')?.addEventListener('submit', function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    
    const payload = {
      institutionalEmail: formData.get('institutionalEmail'),
      password: formData.get('password')
    };

    fetch('http://localhost:8080/auth/login', {
      method: 'POST',
      body: JSON.stringify(payload),
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(async (response) => {
      if (!response.ok) {
        const error = await response.text();
        console.error('Error de autenticaci√≥n:', error);
        alert('Credenciales inv√°lidas o error de servidor.');
        return;
      }

      return response.json();
    })
    .then(data => {
      if (data?.token) {
        localStorage.setItem('token', data.token);
        localStorage.setItem('user', JSON.stringify(data.userResponse));
        window.location.href = `/dashboard/${data.userType}`;
      }
    })
    .catch(error => {
      console.error('Error en la petici√≥n:', error);
    });
  });
</script>